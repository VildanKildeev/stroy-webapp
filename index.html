<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–°–¢–†–û–ô –ø–æ –ö–ê—Ä–º–∞–Ω—É</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            color: white;
            overflow: hidden;
            background: black;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        .background-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }
        .button-container {
            margin-top: 25vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            opacity: 0;
            z-index: 10;
        }
        button {
            color: white;
            border: 2px solid white;
            padding: 20px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            width: 80%;
            max-width: 350px;
            text-align: center;
            background-color: transparent;
            background-position: center;
            background-size: cover;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }
        button::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: inherit;
            background-position: center;
            background-size: cover;
            filter: brightness(0.9);
            border-radius: 10px;
            z-index: -1;
        }
        button::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            z-index: -1;
            pointer-events: none;
        }
        button span {
            position: relative;
            z-index: 2;
            text-shadow: 1px 1px 2px black;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        .about-link {
            margin-top: 60px;
            font-size: 16px;
            color: #ecf0f1;
            text-decoration: underline;
            cursor: pointer;
            text-align: center;
            opacity: 0;
            z-index: 10;
        }
        /* –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω */
        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 300;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
        }
        .start-content {
            background: rgba(30, 30, 30, 0.9);
            border: 2px solid white;
            border-radius: 20px;
            padding: 40px;
            max-width: 90%;
            width: 100%;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
        }
        .start-title {
            color: white;
            font-size: 28px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        .start-message {
            color: #ecf0f1;
            font-size: 18px;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        .start-button {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 18px 30px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
            max-width: 320px;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            background: linear-gradient(45deg, #2980b9, #3498db);
        }
        /* === –ú–æ–¥–∞–ª–∫–∞ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ === */
        #cityModal .modal-content {
            background: rgba(30, 30, 30, 0.95);
            border: 2px solid white;
            max-width: 400px;
        }
        #citySearchContainer {
            position: relative;
            width: 100%;
        }
        #citySearch {
            padding: 12px 12px 12px 40px;
            width: 100%;
            margin-bottom: 15px;
            border: 1px solid #555;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
            background: #222;
            color: white;
        }
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
            font-size: 18px;
            pointer-events: none;
        }
        .remember-checkbox {
            margin-top: 10px;
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #ccc;
        }
        .remember-checkbox input {
            margin-right: 6px;
        }
        /* –ö–Ω–æ–ø–∫–∞ "–°–º–µ–Ω–∏—Ç—å –≥–æ—Ä–æ–¥" */
        #changeCityButton {
            margin-left: 10px;
            font-size: 14px;
            color: #1e90ff;
            text-decoration: underline;
            cursor: pointer;
            vertical-align: middle;
        }
        /* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ */
        .selected-city {
            margin-top: 15px;
            font-size: 18px;
            color: #fff;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <video autoplay muted loop playsinline class="background-video" id="bgVideo">
        <source src="background.mp4" type="video/mp4">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
    </video>
    <audio id="clickSound" src="click.mp3"></audio>

    <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
    <div class="start-screen" id="startScreen">
        <div class="start-content">
            <h1 class="start-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
            <p class="start-message">
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑,
                –≤—ã–∑–≤–∞—Ç—å –º–∞—Å—Ç–µ—Ä–∞ –∏–ª–∏ –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫—É. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–æ–µ–∫—Ç–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ... –ó–¥–µ—Å—å –≤—Å—ë –ø—Ä–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ! –ù–∞—á–Ω–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!
            </p>
            <button class="start-button" id="openAppButton">
                –ü–û–°–¢–†–û–ò–¢–¨!
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ -->
    <div class="modal" id="cityModal">
        <div class="modal-content">
            <div class="modal-title">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</div>
            <div id="citySearchContainer">
                <span class="search-icon">üîç</span>
                <input type="text" id="citySearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É...">
            </div>
            <div id="cityList" style="max-height: 400px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px;">
                <!-- –ì–æ—Ä–æ–¥–∞ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="remember-checkbox">
                <input type="checkbox" id="rememberCityCheckbox">
                <label for="rememberCityCheckbox">–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–æ–π –≤—ã–±–æ—Ä</label>
            </div>
            <div style="color: #aaa; font-size: 14px; margin-top: 15px;">
                –ù–µ –Ω–∞—à–ª–∏ —Å–≤–æ–π –≥–æ—Ä–æ–¥? –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º ‚Äî —Ä–∞–±–æ—Ç–∞–µ–º –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏
            </div>
        </div>
    </div>

    <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ -->
    <div class="selected-city" id="selectedCityDisplay">
        <span>–ì–æ—Ä–æ–¥: <span id="cityName">–ù–µ –≤—ã–±—Ä–∞–Ω</span></span>
        <span id="changeCityButton">–°–º–µ–Ω–∏—Ç—å</span>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
    <div class="button-container" id="buttonContainer">
        <button style="background-image: url('btn-master.jpg');" id="masterButton">
            <span>–ù–ê–ù–Ø–¢–¨ –ú–ê–°–¢–ï–†–ê / –ù–ê–ô–¢–ò –ë–†–ò–ì–ê–î–£<br><small>(–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã)</small></span>
        </button>
        <button style="background-image: url('btn-shop.jpg');" id="shopButton">
            <span>–ò–ù–¢–ï–†–ù–ï–¢ –ú–ê–ì–ê–ó–ò–ù –°–¢–†–û–ô–ú–ê–¢–ï–†–ò–ê–õ–û–í<br><small>(–Ω–æ–≤—ã–µ –∏ –±/—É, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–∞—Ç—å —Å–≤–æ–∏)</small></span>
        </button>
        <button style="background-image: url('btn-machinery.jpg');" id="machineryButton">
            <span>–°–ü–ï–¶–¢–ï–•–ù–ò–ö–ê –ò –ò–ù–°–¢–†–£–ú–ï–ù–¢–´<br><small>(–∞—Ä–µ–Ω–¥–∞ / –ø—Ä–æ–∫–∞—Ç)</small></span>
        </button>
    </div>

    <div class="about-link" id="aboutLink">–û –Ω–∞—Å</div>

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
        const cities = [
            "–ê–±–∞–∫–∞–Ω", "–ê–ª—å–º–µ—Ç—å–µ–≤—Å–∫", "–ê–Ω–≥–∞—Ä—Å–∫", "–ê—Ä–º–∞–≤–∏—Ä", "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫", "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å",
            "–ë–∞–ª–∞–∫–æ–≤–æ", "–ë–∞–ª–∞—à–∏—Ö–∞", "–ë–∞—Ä–Ω–∞—É–ª", "–ë–µ–ª–≥–æ—Ä–æ–¥", "–ë–µ—Ä–µ–∑–Ω–∏–∫–∏", "–ë–∏–π—Å–∫", "–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫", "–ë—Ä–∞—Ç—Å–∫", "–ë—Ä—è–Ω—Å–∫",
            "–í–µ–ª–∏–∫–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥", "–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫", "–í–ª–∞–¥–∏–∫–∞–≤–∫–∞–∑", "–í–ª–∞–¥–∏–º–∏—Ä", "–í–æ–ª–≥–æ–≥—Ä–∞–¥", "–í–æ–ª–≥–æ–¥–æ–Ω—Å–∫", "–í–æ–ª–∂—Å–∫–∏–π", "–í–æ–ª–æ–≥–¥–∞", "–í–æ—Ä–æ–Ω–µ–∂",
            "–ì—Ä–æ–∑–Ω—ã–π", "–î–µ—Ä–±–µ–Ω—Ç", "–î–∑–µ—Ä–∂–∏–Ω—Å–∫", "–î–∏–º–∏—Ç—Ä–æ–≤–≥—Ä–∞–¥", "–î–æ–ª–≥–æ–ø—Ä—É–¥–Ω—ã–π", "–î–æ–º–æ–¥–µ–¥–æ–≤–æ",
            "–ï–≤–ø–∞—Ç–æ—Ä–∏—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ï–ª–µ—Ü", "–ñ–µ–ª–µ–∑–Ω–æ–≥–æ—Ä—Å–∫ (–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π)", "–ñ—É–∫–æ–≤—Å–∫–∏–π", "–ó–ª–∞—Ç–æ—É—Å—Ç",
            "–ò–≤–∞–Ω–æ–≤–æ", "–ò–∂–µ–≤—Å–∫", "–ò—Ä–∫—É—Ç—Å–∫", "–ô–æ—à–∫–∞—Ä-–û–ª–∞",
            "–ö–∞–∑–∞–Ω—å", "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥", "–ö–∞–ª—É–≥–∞", "–ö–µ–º–µ—Ä–æ–≤–æ", "–ö–∏—Ä–æ–≤", "–ö–æ—Å—Ç—Ä–æ–º–∞", "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä", "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫", "–ö—É—Ä–≥–∞–Ω", "–ö—É—Ä—Å–∫", "–ö—ã–∑—ã–ª",
            "–õ–∏–ø–µ—Ü–∫", "–ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫", "–ú–∞–π–∫–æ–ø", "–ú–∞—Ö–∞—á–∫–∞–ª–∞", "–ú–∏–∞—Å—Å", "–ú–æ—Å–∫–≤–∞", "–ú—É—Ä–º–∞–Ω—Å–∫", "–ú—É—Ä–æ–º", "–ú—ã—Ç–∏—â–∏",
            "–ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã", "–ù–∞–ª—å—á–∏–∫", "–ù–∞—Ö–æ–¥–∫–∞", "–ù–µ—Ñ—Ç–µ—é–≥–∞–Ω—Å–∫", "–ù–∏–∂–Ω–µ–≤–∞—Ä—Ç–æ–≤—Å–∫", "–ù–∏–∂–Ω–µ–∫–∞–º—Å–∫", "–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥", "–ù–∏–∂–Ω–∏–π –¢–∞–≥–∏–ª", "–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "–ù–æ–≤–æ—á–µ—Ä–∫–∞—Å—Å–∫", "–ù–æ—Ä–∏–ª—å—Å–∫",
            "–û–±–Ω–∏–Ω—Å–∫", "–û–¥–∏–Ω—Ü–æ–≤–æ", "–û–º—Å–∫", "–û—Ä–µ–ª", "–û—Ä–µ–Ω–±—É—Ä–≥", "–û—Ä—Å–∫", "–ü–µ–Ω–∑–∞", "–ü–µ—Ä–º—å", "–ü–µ—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫", "–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫-–ö–∞–º—á–∞—Ç—Å–∫–∏–π", "–ü–æ–¥–æ–ª—å—Å–∫", "–ü—Ä–æ–∫–æ–ø—å–µ–≤—Å–∫", "–ü—Å–∫–æ–≤", "–ü—è—Ç–∏–≥–æ—Ä—Å–∫",
            "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É", "–†—ã–±–∏–Ω—Å–∫", "–†—è–∑–∞–Ω—å",
            "–°–∞–º–∞—Ä–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–°–∞—Ä–∞–Ω—Å–∫", "–°–∞—Ä–∞—Ç–æ–≤", "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å", "–°–µ–≤–µ—Ä–æ–¥–≤–∏–Ω—Å–∫", "–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å", "–°–º–æ–ª–µ–Ω—Å–∫", "–°–æ—á–∏", "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å", "–°—Ç–∞—Ä—ã–π –û—Å–∫–æ–ª", "–°—Ç–µ—Ä–ª–∏—Ç–∞–º–∞–∫", "–°—É—Ä–≥—É—Ç", "–°—ã–∫—Ç—ã–≤–∫–∞—Ä",
            "–¢–∞–≥–∞–Ω—Ä–æ–≥", "–¢–∞–º–±–æ–≤", "–¢–≤–µ—Ä—å", "–¢–æ–ª—å—è—Ç—Ç–∏", "–¢–æ–º—Å–∫", "–¢—É–ª–∞", "–¢—é–º–µ–Ω—å",
            "–£–ª–∞–Ω-–£–¥—ç", "–£–ª—å—è–Ω–æ–≤—Å–∫", "–£—Å—Å—É—Ä–∏–π—Å–∫", "–£—Ñ–∞",
            "–•–∞–±–∞—Ä–æ–≤—Å–∫", "–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫", "–ß–µ–±–æ–∫—Å–∞—Ä—ã", "–ß–µ–ª—è–±–∏–Ω—Å–∫", "–ß–µ—Ä–µ–ø–æ–≤–µ—Ü", "–ß–µ—Ä–∫–µ—Å—Å–∫", "–ß–∏—Ç–∞",
            "–®–∞—Ö—Ç—ã", "–©—ë–ª–∫–æ–≤–æ", "–≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å", "–≠–ª–∏—Å—Ç–∞", "–≠–Ω–≥–µ–ª—å—Å",
            "–Æ–∂–Ω–æ-–°–∞—Ö–∞–ª–∏–Ω—Å–∫", "–Ø–∫—É—Ç—Å–∫", "–Ø—Ä–æ—Å–ª–∞–≤–ª—å"
        ];
        let selectedCity = null;

        // Telegram WebApp
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.BackButton.show();
            tg.BackButton.onClick(() => {
                tg.close();
            });
        }

        function playSound() {
            const clickSound = document.getElementById('clickSound');
            if (clickSound) {
                clickSound.currentTime = 0;
                clickSound.play().catch(e => console.log("–ó–≤—É–∫ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω"));
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫–ª–æ–Ω–µ–Ω–∏—è –≥–æ—Ä–æ–¥–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–Ω–æ–º –ø–∞–¥–µ–∂–µ
        function getCityInPrepositional(city) {
            const exceptions = {
                "–ú–æ—Å–∫–≤–∞": "–≤ –ú–æ—Å–∫–≤–µ", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥": "–≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥": "–≤ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–µ",
                "–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥": "–≤ –ù–∏–∂–Ω–µ–º –ù–æ–≤–≥–æ—Ä–æ–¥–µ", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫": "–≤ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–µ", "–ö–∞–∑–∞–Ω—å": "–≤ –ö–∞–∑–∞–Ω–∏",
                "–°–∞–º–∞—Ä–∞": "–≤ –°–∞–º–∞—Ä–µ", "–û–º—Å–∫": "–≤ –û–º—Å–∫–µ", "–ß–µ–ª—è–±–∏–Ω—Å–∫": "–≤ –ß–µ–ª—è–±–∏–Ω—Å–∫–µ", "–£—Ñ–∞": "–≤ –£—Ñ–µ",
                "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É": "–≤ –†–æ—Å—Ç–æ–≤–µ-–Ω–∞-–î–æ–Ω—É", "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫": "–≤ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–µ", "–ü–µ—Ä–º—å": "–≤ –ü–µ—Ä–º–∏",
                "–í–æ—Ä–æ–Ω–µ–∂": "–≤ –í–æ—Ä–æ–Ω–µ–∂–µ", "–í–æ–ª–≥–æ–≥—Ä–∞–¥": "–≤ –í–æ–ª–≥–æ–≥—Ä–∞–¥–µ", "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä": "–≤ –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä–µ",
                "–¢—é–º–µ–Ω—å": "–≤ –¢—é–º–µ–Ω–∏", "–ò–∂–µ–≤—Å–∫": "–≤ –ò–∂–µ–≤—Å–∫–µ", "–ë–∞—Ä–Ω–∞—É–ª": "–≤ –ë–∞—Ä–Ω–∞—É–ª–µ", "–£–ª–∞–Ω-–£–¥—ç": "–≤ –£–ª–∞–Ω-–£–¥—ç",
                "–Ø—Ä–æ—Å–ª–∞–≤–ª—å": "–≤ –Ø—Ä–æ—Å–ª–∞–≤–ª–µ", "–•–∞–±–∞—Ä–æ–≤—Å–∫": "–≤ –•–∞–±–∞—Ä–æ–≤—Å–∫–µ", "–ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫": "–≤ –ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫–µ",
                "–¢–æ–º—Å–∫": "–≤ –¢–æ–º—Å–∫–µ", "–û—Ä–µ–Ω–±—É—Ä–≥": "–≤ –û—Ä–µ–Ω–±—É—Ä–≥–µ", "–ö–µ–º–µ—Ä–æ–≤–æ": "–≤ –ö–µ–º–µ—Ä–æ–≤–æ", "–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫": "–≤ –ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫–µ",
                "–†—è–∑–∞–Ω—å": "–≤ –†—è–∑–∞–Ω–∏", "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å": "–≤ –ê—Å—Ç—Ä–∞—Ö–∞–Ω–∏", "–ü–µ–Ω–∑–∞": "–≤ –ü–µ–Ω–∑–µ", "–õ–∏–ø–µ—Ü–∫": "–≤ –õ–∏–ø–µ—Ü–∫–µ",
                "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å": "–≤ –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª–µ", "–ë–µ–ª–≥–æ—Ä–æ–¥": "–≤ –ë–µ–ª–≥–æ—Ä–æ–¥–µ", "–ö—É—Ä—Å–∫": "–≤ –ö—É—Ä—Å–∫–µ", "–°–æ—á–∏": "–≤ –°–æ—á–∏"
            };
            return exceptions[city] || (['–∞', '—è'].includes(city.slice(-1)) ? `–≤ ${city.replace(/–∞$/, '–µ').replace(/—è$/, '–µ')}` : `–≤ ${city}–µ`);
        }

        function updateButtonTitles(city) {
            if (!city) return;
            const cityInCase = getCityInPrepositional(city);
            document.getElementById('masterButton').innerHTML = `
                <span>–ù–ê–ù–Ø–¢–¨ –ú–ê–°–¢–ï–†–ê ${cityInCase}<br><small>(–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã)</small></span>
            `;
            document.getElementById('shopButton').innerHTML = `
                <span>–ò–ù–¢–ï–†–ù–ï–¢ –ú–ê–ì–ê–ó–ò–ù ${cityInCase}<br><small>(–Ω–æ–≤—ã–µ –∏ –±/—É, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–∞—Ç—å —Å–≤–æ–∏)</small></span>
            `;
            document.getElementById('machineryButton').innerHTML = `
                <span>–°–ü–ï–¶–¢–ï–•–ù–ò–ö–ê ${cityInCase}<br><small>(–∞—Ä–µ–Ω–¥–∞ / –ø—Ä–æ–∫–∞—Ç)</small></span>
            `;
        }

        function showMainContent() {
            const btnContainer = document.getElementById('buttonContainer');
            const aboutLink = document.getElementById('aboutLink');
            const cityDisplay = document.getElementById('selectedCityDisplay');
            const cityNameSpan = document.getElementById('cityName');
            cityNameSpan.textContent = selectedCity || '–ù–µ –≤—ã–±—Ä–∞–Ω';
            updateButtonTitles(selectedCity);
            cityDisplay.style.opacity = 1;
            setTimeout(() => {
                btnContainer.style.opacity = 1;
                btnContainer.classList.add('animate__animated', 'animate__fadeInUp');
                setTimeout(() => {
                    aboutLink.style.opacity = 1;
                    aboutLink.classList.add('animate__animated', 'animate__fadeInUp');
                }, 250);
            }, 300);
        }

        // === –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª–∫–∏ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ ===
        function initCityModal() {
            const cityList = document.getElementById('cityList');
            const citySearch = document.getElementById('citySearch');
            const rememberCheckbox = document.getElementById('rememberCityCheckbox');

            function renderCities(filteredCities = cities) {
                cityList.innerHTML = '';
                filteredCities.forEach(city => {
                    const btn = document.createElement('button');
                    btn.textContent = city.toUpperCase();
                    btn.style.cssText = `
                        padding: 12px;
                        background: rgba(255,255,255,0.1);
                        border: 1px solid #444;
                        border-radius: 8px;
                        color: white;
                        cursor: pointer;
                        transition: background 0.2s;
                        font-size: 13px;
                        text-align: center;
                        width: 100%;
                        box-sizing: border-box;
                    `;
                    btn.onmouseover = () => btn.style.background = 'rgba(255,255,255,0.2)';
                    btn.onmouseout = () => btn.style.background = 'rgba(255,255,255,0.1)';
                    btn.onclick = () => {
                        selectedCity = city;
                        playSound();
                        if (rememberCheckbox.checked) {
                            localStorage.setItem('selectedCity', city);
                        } else {
                            localStorage.removeItem('selectedCity');
                        }
                        setTimeout(() => {
                            document.getElementById('cityModal').classList.remove('active');
                            showMainContent();
                        }, 150);
                    };
                    cityList.appendChild(btn);
                });
            }

            citySearch.addEventListener('input', () => {
                const query = citySearch.value.toLowerCase().trim();
                const filtered = query ? cities.filter(city => city.toLowerCase().includes(query)) : cities;
                renderCities(filtered);
            });

            renderCities();
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–°–º–µ–Ω–∏—Ç—å –≥–æ—Ä–æ–¥"
        function setupChangeCityButton() {
            document.getElementById('changeCityButton').addEventListener('click', () => {
                playSound();
                initCityModal();
                document.getElementById('cityModal').classList.add('active');
            });
        }

        // === –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ===
        window.addEventListener('load', () => {
            // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
            document.getElementById('startScreen').style.display = 'flex';

            // –ö–Ω–æ–ø–∫–∞ "–ü–û–°–¢–†–û–ò–¢–¨!"
            document.getElementById('openAppButton').addEventListener('click', () => {
                playSound();
                document.getElementById('startScreen').style.display = 'none';
                initCityModal();
                setTimeout(() => {
                    document.getElementById('cityModal').classList.add('active');
                }, 100);
            });

            setupChangeCityButton();

            // === –ö–ù–û–ü–ö–ò –ü–ï–†–ï–•–û–î–Ø–¢ –ù–ê HTML-–§–ê–ô–õ–´ ===
            document.getElementById('masterButton').addEventListener('click', () => {
                playSound();
                const cityParam = selectedCity ? `?city=${encodeURIComponent(selectedCity)}` : '';
                if (tg) {
                    tg.openLink('master.html' + cityParam);
                } else {
                    window.location.href = 'master.html' + cityParam;
                }
            });

            document.getElementById('shopButton').addEventListener('click', () => {
                playSound();
                const cityParam = selectedCity ? `?city=${encodeURIComponent(selectedCity)}` : '';
                if (tg) {
                    tg.openLink('shop.html' + cityParam);
                } else {
                    window.location.href = 'shop.html' + cityParam;
                }
            });

            document.getElementById('machineryButton').addEventListener('click', () => {
                playSound();
                const cityParam = selectedCity ? `?city=${encodeURIComponent(selectedCity)}` : '';
                if (tg) {
                    tg.openLink('machinery.html' + cityParam);
                } else {
                    window.location.href = 'machinery.html' + cityParam;
                }
            });

            // –°—Å—ã–ª–∫–∞ "–û –Ω–∞—Å"
            document.getElementById('aboutLink').addEventListener('click', () => {
                playSound();
                if (tg) {
                    tg.openLink('https://t.me/+JNKZPQaVBGhlMzQ6');
                } else {
                    window.open('https://t.me/+JNKZPQaVBGhlMzQ6', '_blank');
                }
            });
        });
    </script>
</body>
</html>