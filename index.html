<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–°–¢–†–û–ô –ø–æ –ö–ê—Ä–º–∞–Ω—É</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            color: white;
            overflow: hidden;
            background: black;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        .background-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }
        .button-container {
            margin-top: 25vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            opacity: 0;
            z-index: 10;
        }
        button {
            color: white;
            border: 2px solid white;
            padding: 20px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            width: 80%;
            max-width: 350px;
            text-align: center;
            background-color: transparent;
            background-position: center;
            background-size: cover;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }
        button::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: inherit;
            background-position: center;
            background-size: cover;
            filter: brightness(0.9);
            border-radius: 10px;
            z-index: -1;
        }
        button::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            z-index: -1;
            pointer-events: none;
        }
        button span {
            position: relative;
            z-index: 2;
            text-shadow: 1px 1px 2px black;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        .about-link {
            margin-top: 60px;
            font-size: 16px;
            color: #ecf0f1;
            text-decoration: underline;
            cursor: pointer;
            text-align: center;
            opacity: 0;
            z-index: 10;
        }
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        .modal-content {
            background: transparent;
            border: 2px solid white;
            border-radius: 15px;
            padding: 30px;
            width: 80%;
            max-width: 350px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow: hidden;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }
        .modal-content::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-position: center;
            background-size: cover;
            background-repeat: no-repeat;
            z-index: -1;
        }
        .master-modal-content::before {
            background-image: url('modal-background.jpg');
        }
        .shop-modal-content::before {
            background-image: url('modal-shop.jpg');
        }
        .machinery-modal-content::before {
            background-image: url('modal-machinery.jpg');
        }
        .trade-modal-content::before {
            background-image: url('modal-shop.jpg');
        }
        .phone-modal-content {
            background: rgba(40, 40, 40, 0.95);
        }
        .modal-title {
            font-size: 24px;
            margin-bottom: 30px;
            color: white;
            text-align: center;
            text-shadow: 1px 1px 2px black;
        }
        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            align-items: center;
        }
        .modal-button {
            color: white;
            border: 2px solid white;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            background: transparent;
            transition: all 0.3s ease;
            width: 100%;
            max-width: 300px;
            text-align: center;
            text-shadow: 1px 1px 2px black;
        }
        .modal-button:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            color: white;
            cursor: pointer;
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            text-shadow: 1px 1px 2px black;
        }
        .phone-number {
            font-size: 24px;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            word-break: break-all;
        }
        /* –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω */
        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 300;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
        }
        .start-content {
            background: rgba(30, 30, 30, 0.9);
            border: 2px solid white;
            border-radius: 20px;
            padding: 40px;
            max-width: 90%;
            width: 100%;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
        }
        .start-title {
            color: white;
            font-size: 28px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        .start-message {
            color: #ecf0f1;
            font-size: 18px;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        .start-button {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 18px 30px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
            max-width: 320px;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            background: linear-gradient(45deg, #2980b9, #3498db);
        }
        /* iOS Telegram –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ */
        .ios-telegram-warning {
            display: none;
            background: rgba(200, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
            text-align: center;
        }
        /* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è */
        .instructions {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
            line-height: 1.4;
        }
        /* === –ú–æ–¥–∞–ª–∫–∞ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ === */
        #cityModal .modal-content {
            background: rgba(30, 30, 30, 0.95);
            border: 2px solid white;
            max-width: 400px;
        }
        #citySearchContainer {
            position: relative;
            width: 100%;
        }
        #citySearch {
            padding: 12px 12px 12px 40px;
            width: 100%;
            margin-bottom: 15px;
            border: 1px solid #555;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
            background: #222;
            color: white;
        }
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
            font-size: 18px;
            pointer-events: none;
        }
        .remember-checkbox {
            margin-top: 10px;
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #ccc;
        }
        .remember-checkbox input {
            margin-right: 6px;
        }
        /* –ö–Ω–æ–ø–∫–∞ "–°–º–µ–Ω–∏—Ç—å –≥–æ—Ä–æ–¥" */
        #changeCityButton {
            margin-left: 10px;
            font-size: 14px;
            color: #1e90ff;
            text-decoration: underline;
            cursor: pointer;
            vertical-align: middle;
        }
        /* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ */
        .selected-city {
            margin-top: 15px;
            font-size: 18px;
            color: #fff;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <video autoplay muted loop playsinline class="background-video" id="bgVideo">
        <source src="background.mp4" type="video/mp4">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
    </video>
    <audio id="clickSound" src="click.mp3"></audio>

    <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
    <div class="start-screen" id="startScreen">
        <div class="start-content">
            <h1 class="start-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
            <p class="start-message">
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑,
                –≤—ã–∑–≤–∞—Ç—å –º–∞—Å—Ç–µ—Ä–∞ –∏–ª–∏ –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫—É. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–æ–µ–∫—Ç–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ... –ó–¥–µ—Å—å –≤—Å—ë –ø—Ä–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ! –ù–∞—á–Ω–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!
            </p>
            <button class="start-button" id="openAppButton">
                –ü–û–°–¢–†–û–ò–¢–¨!
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ -->
    <div class="modal" id="cityModal">
        <div class="modal-content">
            <div class="modal-title">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</div>
            <div id="citySearchContainer">
                <span class="search-icon">üîç</span>
                <input type="text" id="citySearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É...">
            </div>
            <div id="cityList" style="max-height: 400px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px;">
                <!-- –ì–æ—Ä–æ–¥–∞ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="remember-checkbox">
                <input type="checkbox" id="rememberCityCheckbox">
                <label for="rememberCityCheckbox">–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–æ–π –≤—ã–±–æ—Ä</label>
            </div>
            <div style="color: #aaa; font-size: 14px; margin-top: 15px;">
                –ù–µ –Ω–∞—à–ª–∏ —Å–≤–æ–π –≥–æ—Ä–æ–¥? –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º ‚Äî —Ä–∞–±–æ—Ç–∞–µ–º –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏
            </div>
        </div>
    </div>

    <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ -->
    <div class="selected-city" id="selectedCityDisplay">
        <span>–ì–æ—Ä–æ–¥: <span id="cityName">–ù–µ –≤—ã–±—Ä–∞–Ω</span></span>
        <span id="changeCityButton">–°–º–µ–Ω–∏—Ç—å</span>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
    <div class="button-container" id="buttonContainer">
        <button style="background-image: url('btn-master.jpg');" id="masterButton">
            <span>–ù–ê–ù–Ø–¢–¨ –ú–ê–°–¢–ï–†–ê / –ù–ê–ô–¢–ò –ë–†–ò–ì–ê–î–£<br><small>(–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã)</small></span>
        </button>
        <button style="background-image: url('btn-shop.jpg');" id="shopButton">
            <span>–ò–ù–¢–ï–†–ù–ï–¢ –ú–ê–ì–ê–ó–ò–ù –°–¢–†–û–ô–ú–ê–¢–ï–†–ò–ê–õ–û–í<br><small>(–Ω–æ–≤—ã–µ –∏ –±/—É, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–∞—Ç—å —Å–≤–æ–∏)</small></span>
        </button>
        <button style="background-image: url('btn-machinery.jpg');" id="machineryButton">
            <span>–°–ü–ï–¶–¢–ï–•–ù–ò–ö–ê –ò –ò–ù–°–¢–†–£–ú–ï–ù–¢–´<br><small>(–∞—Ä–µ–Ω–¥–∞ / –ø—Ä–æ–∫–∞—Ç)</small></span>
        </button>
    </div>

    <div class="about-link" id="aboutLink">–û –Ω–∞—Å</div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–æ—Å—Ç–∞—é—Ç—Å—è –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–Ω–æ–ø–æ–∫) -->
    <div class="modal" id="shopModal">
        <button class="close-modal">√ó</button>
        <div class="modal-content shop-modal-content">
            <div class="modal-title">–ò–ù–¢–ï–†–ù–ï–¢ –ú–ê–ì–ê–ó–ò–ù</div>
            <div class="modal-buttons">
                <button class="modal-button" id="shopWhatsAppButton">–°–î–ï–õ–ê–¢–¨ –û–ù–õ–ê–ô–ù –ó–ê–Ø–í–ö–£</button>
                <button class="modal-button" id="shopCallButton">–ü–û–ó–í–û–ù–ò–¢–¨ –ü–û –¢–ï–õ–ï–§–û–ù—É</button>
                <button class="modal-button" id="tradeMaterialsButton">–ö–£–ü–ò / –ü–†–û–î–ê–ô –û–°–¢–ê–¢–ö–ò<br><small>–ù–û–í–´–ï –ò –ë/–£</small></button>
            </div>
        </div>
    </div>

    <div class="modal" id="tradeModal">
        <button class="close-modal">√ó</button>
        <div class="modal-content trade-modal-content">
            <div class="modal-title">–ö–£–ü–ò / –ü–†–û–î–ê–ô –û–°–¢–ê–¢–ö–ò</div>
            <div class="modal-buttons">
                <button class="modal-button" id="buyMaterialsButton">–ö–£–ü–ò–¢–¨</button>
                <button class="modal-button" id="sellMaterialsButton">–ü–†–û–î–ê–¢–¨</button>
            </div>
        </div>
    </div>

    <div class="modal" id="machineryModal">
        <button class="close-modal">√ó</button>
        <div class="modal-content machinery-modal-content">
            <div class="modal-title">–°–ü–ï–¶–¢–ï–•–ù–ò–ö–ê –ò –ò–ù–°–¢–†–£–ú–ï–ù–¢–´</div>
            <div class="modal-buttons">
                <button class="modal-button" id="machineryWhatsAppButton">–ê–†–ï–ù–î–û–í–ê–¢–¨ –û–ù–õ–ê–ô–ù</button>
                <button class="modal-button" id="machineryCallButton">–ê–†–ï–ù–î–û–í–ê–¢–¨ –ü–û –¢–ï–õ–ï–§–û–ù—É</button>
            </div>
        </div>
    </div>

    <div class="modal" id="phoneModal">
        <button class="close-modal">√ó</button>
        <div class="modal-content phone-modal-content">
            <div class="modal-title">–ü–æ–∑–≤–æ–Ω–∏—Ç—å</div>
            <div class="phone-number" id="displayPhoneNumber"></div>
            <div class="ios-telegram-warning" id="iosTelegramWarning">
                –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Telegram –¥–ª—è iOS –∑–≤–æ–Ω–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.<br>
                –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–º–µ—Ä –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–¢–µ–ª–µ—Ñ–æ–Ω"
            </div>
            <div class="modal-buttons">
                <button class="modal-button" id="directCallButton">–ü–û–ó–í–û–ù–ò–¢–¨</button>
                <button class="modal-button" id="copyPhoneButton">–°–ö–û–ü–ò–†–û–í–ê–¢–¨ –ù–û–ú–ï–†</button>
            </div>
            <div class="instructions" id="iosInstructions" style="display: none;">
                <strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è iOS –≤ Telegram:</strong><br>
                1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–º–µ—Ä<br>
                2. –í—ã–π–¥–∏—Ç–µ –∏–∑ Telegram<br>
                3. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–¢–µ–ª–µ—Ñ–æ–Ω"<br>
                4. –í—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä –∏ –Ω–∞–∂–º–∏—Ç–µ –≤—ã–∑–æ–≤
            </div>
        </div>
    </div>

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
        const cities = [
            "–ê–±–∞–∫–∞–Ω", "–ê–ª—å–º–µ—Ç—å–µ–≤—Å–∫", "–ê–Ω–≥–∞—Ä—Å–∫", "–ê—Ä–º–∞–≤–∏—Ä", "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫", "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å",
            "–ë–∞–ª–∞–∫–æ–≤–æ", "–ë–∞–ª–∞—à–∏—Ö–∞", "–ë–∞—Ä–Ω–∞—É–ª", "–ë–µ–ª–≥–æ—Ä–æ–¥", "–ë–µ—Ä–µ–∑–Ω–∏–∫–∏", "–ë–∏–π—Å–∫", "–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫", "–ë—Ä–∞—Ç—Å–∫", "–ë—Ä—è–Ω—Å–∫",
            "–í–µ–ª–∏–∫–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥", "–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫", "–í–ª–∞–¥–∏–∫–∞–≤–∫–∞–∑", "–í–ª–∞–¥–∏–º–∏—Ä", "–í–æ–ª–≥–æ–≥—Ä–∞–¥", "–í–æ–ª–≥–æ–¥–æ–Ω—Å–∫", "–í–æ–ª–∂—Å–∫–∏–π", "–í–æ–ª–æ–≥–¥–∞", "–í–æ—Ä–æ–Ω–µ–∂",
            "–ì—Ä–æ–∑–Ω—ã–π", "–î–µ—Ä–±–µ–Ω—Ç", "–î–∑–µ—Ä–∂–∏–Ω—Å–∫", "–î–∏–º–∏—Ç—Ä–æ–≤–≥—Ä–∞–¥", "–î–æ–ª–≥–æ–ø—Ä—É–¥–Ω—ã–π", "–î–æ–º–æ–¥–µ–¥–æ–≤–æ",
            "–ï–≤–ø–∞—Ç–æ—Ä–∏—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ï–ª–µ—Ü", "–ñ–µ–ª–µ–∑–Ω–æ–≥–æ—Ä—Å–∫ (–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π)", "–ñ—É–∫–æ–≤—Å–∫–∏–π", "–ó–ª–∞—Ç–æ—É—Å—Ç",
            "–ò–≤–∞–Ω–æ–≤–æ", "–ò–∂–µ–≤—Å–∫", "–ò—Ä–∫—É—Ç—Å–∫", "–ô–æ—à–∫–∞—Ä-–û–ª–∞",
            "–ö–∞–∑–∞–Ω—å", "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥", "–ö–∞–ª—É–≥–∞", "–ö–µ–º–µ—Ä–æ–≤–æ", "–ö–∏—Ä–æ–≤", "–ö–æ—Å—Ç—Ä–æ–º–∞", "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä", "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫", "–ö—É—Ä–≥–∞–Ω", "–ö—É—Ä—Å–∫", "–ö—ã–∑—ã–ª",
            "–õ–∏–ø–µ—Ü–∫", "–ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫", "–ú–∞–π–∫–æ–ø", "–ú–∞—Ö–∞—á–∫–∞–ª–∞", "–ú–∏–∞—Å—Å", "–ú–æ—Å–∫–≤–∞", "–ú—É—Ä–º–∞–Ω—Å–∫", "–ú—É—Ä–æ–º", "–ú—ã—Ç–∏—â–∏",
            "–ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã", "–ù–∞–ª—å—á–∏–∫", "–ù–∞—Ö–æ–¥–∫–∞", "–ù–µ—Ñ—Ç–µ—é–≥–∞–Ω—Å–∫", "–ù–∏–∂–Ω–µ–≤–∞—Ä—Ç–æ–≤—Å–∫", "–ù–∏–∂–Ω–µ–∫–∞–º—Å–∫", "–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥", "–ù–∏–∂–Ω–∏–π –¢–∞–≥–∏–ª", "–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "–ù–æ–≤–æ—á–µ—Ä–∫–∞—Å—Å–∫", "–ù–æ—Ä–∏–ª—å—Å–∫",
            "–û–±–Ω–∏–Ω—Å–∫", "–û–¥–∏–Ω—Ü–æ–≤–æ", "–û–º—Å–∫", "–û—Ä–µ–ª", "–û—Ä–µ–Ω–±—É—Ä–≥", "–û—Ä—Å–∫", "–ü–µ–Ω–∑–∞", "–ü–µ—Ä–º—å", "–ü–µ—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫", "–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫-–ö–∞–º—á–∞—Ç—Å–∫–∏–π", "–ü–æ–¥–æ–ª—å—Å–∫", "–ü—Ä–æ–∫–æ–ø—å–µ–≤—Å–∫", "–ü—Å–∫–æ–≤", "–ü—è—Ç–∏–≥–æ—Ä—Å–∫",
            "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É", "–†—ã–±–∏–Ω—Å–∫", "–†—è–∑–∞–Ω—å",
            "–°–∞–º–∞—Ä–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–°–∞—Ä–∞–Ω—Å–∫", "–°–∞—Ä–∞—Ç–æ–≤", "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å", "–°–µ–≤–µ—Ä–æ–¥–≤–∏–Ω—Å–∫", "–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å", "–°–º–æ–ª–µ–Ω—Å–∫", "–°–æ—á–∏", "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å", "–°—Ç–∞—Ä—ã–π –û—Å–∫–æ–ª", "–°—Ç–µ—Ä–ª–∏—Ç–∞–º–∞–∫", "–°—É—Ä–≥—É—Ç", "–°—ã–∫—Ç—ã–≤–∫–∞—Ä",
            "–¢–∞–≥–∞–Ω—Ä–æ–≥", "–¢–∞–º–±–æ–≤", "–¢–≤–µ—Ä—å", "–¢–æ–ª—å—è—Ç—Ç–∏", "–¢–æ–º—Å–∫", "–¢—É–ª–∞", "–¢—é–º–µ–Ω—å",
            "–£–ª–∞–Ω-–£–¥—ç", "–£–ª—å—è–Ω–æ–≤—Å–∫", "–£—Å—Å—É—Ä–∏–π—Å–∫", "–£—Ñ–∞",
            "–•–∞–±–∞—Ä–æ–≤—Å–∫", "–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫", "–ß–µ–±–æ–∫—Å–∞—Ä—ã", "–ß–µ–ª—è–±–∏–Ω—Å–∫", "–ß–µ—Ä–µ–ø–æ–≤–µ—Ü", "–ß–µ—Ä–∫–µ—Å—Å–∫", "–ß–∏—Ç–∞",
            "–®–∞—Ö—Ç—ã", "–©—ë–ª–∫–æ–≤–æ", "–≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å", "–≠–ª–∏—Å—Ç–∞", "–≠–Ω–≥–µ–ª—å—Å",
            "–Æ–∂–Ω–æ-–°–∞—Ö–∞–ª–∏–Ω—Å–∫", "–Ø–∫—É—Ç—Å–∫", "–Ø—Ä–æ—Å–ª–∞–≤–ª—å"
        ];
        let selectedCity = null;

        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
        const WHATSAPP_PHONE_SHOP = "79539991666";
        const CALL_PHONE_SHOP = "+79539991666";
        const WHATSAPP_PHONE_MACHINERY = "79046661000";
        const CALL_PHONE_MACHINERY = "+79046661000";
        const WHATSAPP_PHONE_SELL = "79539991666";
        const TELEGRAM_CHANNEL_URL = "https://t.me/+JNKZPQaVBGhlMzQ6";
        const BUILDING_CHANNEL_URL = "https://t.me/+ZWvnEf6UgzJhYWEy";

        const clickSound = document.getElementById('clickSound');
        const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
        let currentPhoneNumber = '';
        let currentPage = 'main';

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ iOS –≤ Telegram
        const isTelegramIOS = isIOS && navigator.userAgent.includes('Telegram');
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Safari –Ω–∞ iOS
        const isSafariIOS = isIOS && /Safari/.test(navigator.userAgent) && !/CriOS/.test(navigator.userAgent);

        // Telegram WebApp
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.BackButton.show();
            tg.BackButton.onClick(() => {
                if (currentPage === 'main') {
                    tg.close();
                } else {
                    closeAllModals();
                }
            });
        }

        function playSound() {
            if (clickSound) {
                clickSound.currentTime = 0;
                clickSound.play().catch(e => console.log("–ó–≤—É–∫ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω"));
            }
        }

        function openShopModal() {
            closeAllModals();
            currentPage = 'shop';
            if (tg) tg.BackButton.show();
            setTimeout(() => {
                document.getElementById('shopModal').classList.add('active');
            }, 50);
        }

        function openMachineryModal() {
            closeAllModals();
            currentPage = 'machinery';
            if (tg) tg.BackButton.show();
            setTimeout(() => {
                document.getElementById('machineryModal').classList.add('active');
            }, 50);
        }

        function openTradeModal() {
            closeAllModals();
            currentPage = 'trade';
            if (tg) tg.BackButton.show();
            setTimeout(() => {
                document.getElementById('tradeModal').classList.add('active');
            }, 50);
        }

        function closeAllModals() {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(m => m.classList.remove('active'));
            currentPage = 'main';
            if (tg) tg.BackButton.hide();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫–ª–æ–Ω–µ–Ω–∏—è –≥–æ—Ä–æ–¥–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–Ω–æ–º –ø–∞–¥–µ–∂–µ
        function getCityInPrepositional(city) {
            const exceptions = {
                "–ú–æ—Å–∫–≤–∞": "–≤ –ú–æ—Å–∫–≤–µ",
                "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥": "–≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ",
                "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥": "–≤ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–µ",
                "–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥": "–≤ –ù–∏–∂–Ω–µ–º –ù–æ–≤–≥–æ—Ä–æ–¥–µ",
                "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫": "–≤ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–µ",
                "–ö–∞–∑–∞–Ω—å": "–≤ –ö–∞–∑–∞–Ω–∏",
                "–°–∞–º–∞—Ä–∞": "–≤ –°–∞–º–∞—Ä–µ",
                "–û–º—Å–∫": "–≤ –û–º—Å–∫–µ",
                "–ß–µ–ª—è–±–∏–Ω—Å–∫": "–≤ –ß–µ–ª—è–±–∏–Ω—Å–∫–µ",
                "–£—Ñ–∞": "–≤ –£—Ñ–µ",
                "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É": "–≤ –†–æ—Å—Ç–æ–≤–µ-–Ω–∞-–î–æ–Ω—É",
                "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫": "–≤ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–µ",
                "–ü–µ—Ä–º—å": "–≤ –ü–µ—Ä–º–∏",
                "–í–æ—Ä–æ–Ω–µ–∂": "–≤ –í–æ—Ä–æ–Ω–µ–∂–µ",
                "–í–æ–ª–≥–æ–≥—Ä–∞–¥": "–≤ –í–æ–ª–≥–æ–≥—Ä–∞–¥–µ",
                "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä": "–≤ –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä–µ",
                "–¢—é–º–µ–Ω—å": "–≤ –¢—é–º–µ–Ω–∏",
                "–ò–∂–µ–≤—Å–∫": "–≤ –ò–∂–µ–≤—Å–∫–µ",
                "–ë–∞—Ä–Ω–∞—É–ª": "–≤ –ë–∞—Ä–Ω–∞—É–ª–µ",
                "–£–ª–∞–Ω-–£–¥—ç": "–≤ –£–ª–∞–Ω-–£–¥—ç",
                "–Ø—Ä–æ—Å–ª–∞–≤–ª—å": "–≤ –Ø—Ä–æ—Å–ª–∞–≤–ª–µ",
                "–•–∞–±–∞—Ä–æ–≤—Å–∫": "–≤ –•–∞–±–∞—Ä–æ–≤—Å–∫–µ",
                "–ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫": "–≤ –ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫–µ",
                "–¢–æ–º—Å–∫": "–≤ –¢–æ–º—Å–∫–µ",
                "–û—Ä–µ–Ω–±—É—Ä–≥": "–≤ –û—Ä–µ–Ω–±—É—Ä–≥–µ",
                "–ö–µ–º–µ—Ä–æ–≤–æ": "–≤ –ö–µ–º–µ—Ä–æ–≤–æ",
                "–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫": "–≤ –ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫–µ",
                "–†—è–∑–∞–Ω—å": "–≤ –†—è–∑–∞–Ω–∏",
                "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å": "–≤ –ê—Å—Ç—Ä–∞—Ö–∞–Ω–∏",
                "–ü–µ–Ω–∑–∞": "–≤ –ü–µ–Ω–∑–µ",
                "–õ–∏–ø–µ—Ü–∫": "–≤ –õ–∏–ø–µ—Ü–∫–µ",
                "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å": "–≤ –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª–µ",
                "–ë–µ–ª–≥–æ—Ä–æ–¥": "–≤ –ë–µ–ª–≥–æ—Ä–æ–¥–µ",
                "–ö—É—Ä—Å–∫": "–≤ –ö—É—Ä—Å–∫–µ",
                "–°–æ—á–∏": "–≤ –°–æ—á–∏"
            };
            if (exceptions[city]) return exceptions[city];
            const last = city.slice(-1).toLowerCase();
            const lastTwo = city.slice(-2).toLowerCase();
            if (last === '–∞' || last === '—è') {
                return `–≤ ${city.replace(/–∞$/, '–µ').replace(/—è$/, '–µ')}`;
            } else if (last === '—å') {
                return `–≤ ${city}–µ`;
            } else if (lastTwo === '–µ–π') {
                return `–≤ ${city}`;
            } else if (['–æ', '–µ', '–∏'].includes(last)) {
                return `–≤ ${city}`;
            } else {
                return `–≤ ${city}–µ`;
            }
        }

        function updateButtonTitles(city) {
            if (!city) return;
            const cityInCase = getCityInPrepositional(city);
            document.getElementById('masterButton').innerHTML = `
                <span>–ù–ê–ù–Ø–¢–¨ –ú–ê–°–¢–ï–†–ê ${cityInCase}<br><small>(–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã)</small></span>
            `;
            document.getElementById('shopButton').innerHTML = `
                <span>–ò–ù–¢–ï–†–ù–ï–¢ –ú–ê–ì–ê–ó–ò–ù ${cityInCase}<br><small>(–Ω–æ–≤—ã–µ –∏ –±/—É, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–∞—Ç—å —Å–≤–æ–∏)</small></span>
            `;
            document.getElementById('machineryButton').innerHTML = `
                <span>–°–ü–ï–¶–¢–ï–•–ù–ò–ö–ê ${cityInCase}<br><small>(–∞—Ä–µ–Ω–¥–∞ / –ø—Ä–æ–∫–∞—Ç)</small></span>
            `;
        }

        function showMainContent() {
            const btnContainer = document.getElementById('buttonContainer');
            const aboutLink = document.getElementById('aboutLink');
            const cityDisplay = document.getElementById('selectedCityDisplay');
            const cityNameSpan = document.getElementById('cityName');
            cityNameSpan.textContent = selectedCity || '–ù–µ –≤—ã–±—Ä–∞–Ω';
            updateButtonTitles(selectedCity);
            cityDisplay.style.opacity = 1;
            setTimeout(() => {
                btnContainer.style.opacity = 1;
                btnContainer.classList.add('animate__animated', 'animate__fadeInUp');
                setTimeout(() => {
                    aboutLink.style.opacity = 1;
                    aboutLink.classList.add('animate__animated', 'animate__fadeInUp');
                }, 250);
            }, 300);
        }

        // === –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª–∫–∏ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ ===
        function initCityModal() {
            const cityList = document.getElementById('cityList');
            const citySearch = document.getElementById('citySearch');
            const rememberCheckbox = document.getElementById('rememberCityCheckbox');

            function renderCities(filteredCities = cities) {
                cityList.innerHTML = '';
                filteredCities.forEach(city => {
                    const btn = document.createElement('button');
                    btn.textContent = city.toUpperCase();
                    btn.style.cssText = `
                        padding: 12px;
                        background: rgba(255,255,255,0.1);
                        border: 1px solid #444;
                        border-radius: 8px;
                        color: white;
                        cursor: pointer;
                        transition: background 0.2s;
                        font-size: 13px;
                        text-align: center;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        width: 100%;
                        box-sizing: border-box;
                    `;
                    btn.onmouseover = () => btn.style.background = 'rgba(255,255,255,0.2)';
                    btn.onmouseout = () => btn.style.background = 'rgba(255,255,255,0.1)';
                    btn.onclick = () => {
                        selectedCity = city;
                        playSound();
                        if (rememberCheckbox.checked) {
                            localStorage.setItem('selectedCity', city);
                        } else {
                            localStorage.removeItem('selectedCity');
                        }
                        setTimeout(() => {
                            document.getElementById('cityModal').classList.remove('active');
                            showMainContent();
                        }, 150);
                    };
                    cityList.appendChild(btn);
                });
            }

            citySearch.addEventListener('input', () => {
                const query = citySearch.value.toLowerCase().trim();
                const filtered = query ? cities.filter(city => city.toLowerCase().includes(query)) : cities;
                renderCities(filtered);
            });

            renderCities();
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–°–º–µ–Ω–∏—Ç—å –≥–æ—Ä–æ–¥"
        function setupChangeCityButton() {
            document.getElementById('changeCityButton').addEventListener('click', () => {
                playSound();
                initCityModal();
                document.getElementById('cityModal').classList.add('active');
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
            document.getElementById('startScreen').style.display = 'flex';

            // –ö–Ω–æ–ø–∫–∞ "–ü–û–°–¢–†–û–ò–¢–¨!"
            document.getElementById('openAppButton').addEventListener('click', () => {
                playSound();
                document.getElementById('startScreen').style.display = 'none';
                initCityModal();
                setTimeout(() => {
                    document.getElementById('cityModal').classList.add('active');
                }, 100);
            });

            setupChangeCityButton();

            // === –ö–ù–û–ü–ö–ê "–ù–ê–ù–Ø–¢–¨ –ú–ê–°–¢–ï–†–ê" –ü–ï–†–ï–•–û–î–ò–¢ –ù–ê master.html ===
            document.getElementById('masterButton').addEventListener('click', () => {
                playSound();
                const cityParam = selectedCity ? `?city=${encodeURIComponent(selectedCity)}` : '';
                if (tg) {
                    tg.openLink('master.html' + cityParam);
                } else {
                    window.location.href = 'master.html' + cityParam;
                }
            });

            // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å
            document.getElementById('shopButton').addEventListener('click', openShopModal);
            document.getElementById('machineryButton').addEventListener('click', openMachineryModal);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª–æ–∫
            document.getElementById('shopWhatsAppButton').addEventListener('click', () => {
                openWhatsApp(WHATSAPP_PHONE_SHOP, `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω–µ —Å –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π ${getCityInPrepositional(selectedCity || '')}`);
            });
            document.getElementById('shopCallButton').addEventListener('click', () => {
                callPhone(CALL_PHONE_SHOP);
            });
            document.getElementById('tradeMaterialsButton').addEventListener('click', openTradeModal);
            document.getElementById('buyMaterialsButton').addEventListener('click', () => {
                playSound();
                if (tg) {
                    tg.openLink(BUILDING_CHANNEL_URL);
                } else {
                    window.open(BUILDING_CHANNEL_URL, '_blank');
                }
                closeAllModals();
            });
            document.getElementById('sellMaterialsButton').addEventListener('click', () => {
                openWhatsApp(WHATSAPP_PHONE_SELL, `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —è —Ö–æ—á—É –ø—Ä–æ–¥–∞—Ç—å –ª–∏—à–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ ${getCityInPrepositional(selectedCity || '')}! –í–ù–ò–ú–ê–ù–ò–ï!!! –ë—ã–≤—à–∏–µ –≤ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ë–£.`);
            });
            document.getElementById('machineryWhatsAppButton').addEventListener('click', () => {
                openWhatsApp(WHATSAPP_PHONE_MACHINERY, `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫—É ${getCityInPrepositional(selectedCity || '')}!`);
            });
            document.getElementById('machineryCallButton').addEventListener('click', () => {
                callPhone(CALL_PHONE_MACHINERY);
            });
            document.getElementById('directCallButton').addEventListener('click', () => {
                playSound();
                try {
                    const a = document.createElement('a');
                    a.href = `tel:${currentPhoneNumber}`;
                    a.style.display = 'none';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                } catch (e) {
                    console.log("–ó–≤–æ–Ω–æ–∫ –Ω–µ —É–¥–∞–ª—Å—è", e);
                }
            });
            document.getElementById('copyPhoneButton').addEventListener('click', () => {
                copyToClipboard(currentPhoneNumber);
            });
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => {
                    playSound();
                    closeAllModals();
                });
            });
            document.getElementById('aboutLink').addEventListener('click', () => {
                playSound();
                if (tg) {
                    tg.openLink(TELEGRAM_CHANNEL_URL);
                } else {
                    window.open(TELEGRAM_CHANNEL_URL, '_blank');
                }
            });
        });

        // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–≤–æ–Ω–∫–∞
        function callPhone(phoneNumber) {
            playSound();
            currentPhoneNumber = phoneNumber;
            const formatted = formatPhone(phoneNumber);
            document.getElementById('displayPhoneNumber').textContent = formatted;
            document.getElementById('iosTelegramWarning').style.display = isTelegramIOS ? 'block' : 'none';
            document.getElementById('iosInstructions').style.display = isTelegramIOS ? 'block' : 'none';
            closeAllModals();
            setTimeout(() => {
                document.getElementById('phoneModal').classList.add('active');
            }, 100);
            if (isSafariIOS) {
                setTimeout(() => {
                    try {
                        const a = document.createElement('a');
                        a.href = `tel:${phoneNumber}`;
                        a.style.display = 'none';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    } catch (e) {
                        console.log("–ê–≤—Ç–æ–∑–≤–æ–Ω–æ–∫ –Ω–µ —É–¥–∞–ª—Å—è", e);
                    }
                }, 500);
            }
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ WhatsApp
        function openWhatsApp(phone, message) {
            const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
            if (tg) {
                tg.openLink(url);
            } else {
                window.open(url, '_blank');
            }
            closeAllModals();
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞
        async function copyToClipboard(text) {
            playSound();
            try {
                if (navigator.clipboard) {
                    await navigator.clipboard.writeText(text);
                    alert('‚úÖ –ù–æ–º–µ—Ä —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
                    return;
                }
                const tempInput = document.createElement('textarea');
                tempInput.value = text;
                tempInput.style.position = 'fixed';
                tempInput.style.opacity = 0;
                document.body.appendChild(tempInput);
                tempInput.select();
                const result = document.execCommand('copy');
                document.body.removeChild(tempInput);
                if (result) {
                    alert('‚úÖ –ù–æ–º–µ—Ä —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
                } else {
                    throw new Error('Copy command failed');
                }
            } catch (err) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏:", err);
                alert('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤—Ä—É—á–Ω—É—é.');
            }
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞
        function formatPhone(phone) {
            return phone.replace(/(\+)?(\d{1})(\d{3})(\d{3})(\d{2})(\d{2})/, '+$2 ($3) $4-$5-$6');
        }
    </script>
</body>
</html>